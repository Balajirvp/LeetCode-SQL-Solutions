-- Solution 1: (425 ms, 0 B)

SELECT ACTIVITY_DATE AS DAY, COUNT(DISTINCT USER_ID) AS ACTIVE_USERS
FROM ACTIVITY A
WHERE ACTIVITY_DATE > DATE_ADD('2019-07-27', INTERVAL -30 DAY) AND ACTIVITY_DATE <= '2019-07-27'
GROUP BY 1;